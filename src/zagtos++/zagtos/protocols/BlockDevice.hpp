#pragma once

#include <zagtos/UUID.hpp>
#include <zagtos/Messaging.hpp>
#include <zagtos/SharedMemory.hpp>

namespace zagtos {
namespace blockDevice {

static constexpr UUID WRITE(
    0x5a, 0x25, 0x78, 0x96, 0xfe, 0x99, 0x4a, 0x8d, 0xaa, 0x27, 0xc3, 0xb7, 0xe2, 0x76, 0x4b, 0x12);
static constexpr UUID WRITE_RESULT(
    0x49, 0x17, 0x6e, 0x3a, 0x34, 0xcf, 0x46, 0xca, 0xb3, 0xe5, 0x84, 0xce, 0xe1, 0x77, 0x25, 0x61);

namespace send {
struct Allocate {
    static constexpr UUID uuid{
            0x9a, 0x2b, 0xa7, 0x20, 0xe2, 0xd2, 0x4e, 0xcd,
            0xbb, 0x0f, 0xad, 0x0d, 0x46, 0x7f, 0x30, 0xe4};

    size_t length;
    Port &responsePort;

    ZBON_ENCODING_FUNCTIONS(length);
};

struct AllocateResult {
    static constexpr UUID uuid{
            0xa7, 0x3e, 0x75, 0x80, 0x65, 0x70, 0x45, 0x31,
            0xb3, 0xca, 0x69, 0x92, 0xf8, 0x0a, 0xad, 0x14};

    SharedMemory &sharedMemory;
    Port &port;

    ZBON_ENCODING_FUNCTIONS(sharedMemory, port);
};

struct Read {
    static constexpr UUID uuid{
            0x9a, 0x87, 0x13, 0x34, 0x77, 0x63, 0x4e, 0x1a,
            0x9e, 0x42, 0x82, 0x0a, 0x9b, 0x66, 0xf7, 0xf1};

    size_t startSector;
    size_t length;
    Port &responsePort;

    ZBON_ENCODING_FUNCTIONS(startSector, length, responsePort);
};

struct ReadResult {
    static constexpr UUID uuid{
            0x1c, 0xc6, 0x52, 0xd5, 0x53, 0x86, 0x43, 0x99,
            0x80, 0x4e, 0x80, 0xff, 0xf1, 0x16, 0xba, 0x1e};

    bool success;

    ZBON_ENCODING_FUNCTIONS(success);
};
}

namespace receive {
struct Allocate {
    static constexpr UUID uuid{
            0x9a, 0x2b, 0xa7, 0x20, 0xe2, 0xd2, 0x4e, 0xcd,
            0xbb, 0x0f, 0xad, 0x0d, 0x46, 0x7f, 0x30, 0xe4};

    size_t length;
    RemotePort responsePort;

    ZBON_ENCODING_FUNCTIONS(length);
};

struct AllocateResult {
    static constexpr UUID uuid{
            0xa7, 0x3e, 0x75, 0x80, 0x65, 0x70, 0x45, 0x31,
            0xb3, 0xca, 0x69, 0x92, 0xf8, 0x0a, 0xad, 0x14};

    SharedMemory sharedMemory;
    RemotePort port;

    ZBON_ENCODING_FUNCTIONS(sharedMemory, port);
};

struct Read {
    static constexpr UUID uuid{
            0x9a, 0x87, 0x13, 0x34, 0x77, 0x63, 0x4e, 0x1a,
            0x9e, 0x42, 0x82, 0x0a, 0x9b, 0x66, 0xf7, 0xf1};

    size_t startSector;
    size_t length;
    RemotePort responsePort;

    ZBON_ENCODING_FUNCTIONS(startSector, length, responsePort);
};

using send::ReadResult;
}


}
}
